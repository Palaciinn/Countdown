<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Feedback</title>
  <link rel="stylesheet" href="feedbackcss.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" />
</head>
<body>
  <!-- Bloqueo inicial -->
  <div id="lock-screen" class="popup">
    <p class="funny-text">No voy a permitir que cualquiera me dé feedback sobre mi querido contador, primero necesito saber que eres tú al 100% 😤</p>
    <p class="question-text">¿De qué color es la camiseta que te regalé (Me robaste)?</p>
    <input type="text" id="unlock-answer" placeholder="Tu respuesta...">
    <button id="unlock-feedback-btn">Entrar</button>
    <p id="unlock-error" class="error-message"></p>
  </div>

  <!-- Contenido oculto hasta desbloquear -->
  <div id="feedback-content" class="main-content hidden">
    <h1>Deja tu feedback 💌</h1>
    <p class="subtitle">Estoy mejorando este contador con tu ayuda, así que dime qué piensas 😌</p>

    <form id="feedback-form" class="feedback-form" action="https://formspree.io/f/myzpjrkv" method="POST">
      <input type="text" placeholder="Tu nombre (opcional)" name="name" />

      <select name="category" required>
        <option value="">Tipo de feedback</option>
        <option value="idea">💡 Idea nueva</option>
        <option value="bug">🐞 He encontrado un error</option>
        <option value="love">❤️ Me encanta esto</option>
        <option value="other">🤔 Otra cosa</option>
      </select>

      <textarea name="message" rows="5" placeholder="Cuéntame lo que quieras..." required></textarea>

      <button type="submit">Enviar feedback</button>
    </form>

    <p id="form-status" class="funny-text"></p>
  </div>

  <script>
    const correctAnswer = "verde";
    const unlockBtn = document.getElementById("unlock-feedback-btn");
    const answerInput = document.getElementById("unlock-answer");
    const errorText = document.getElementById("unlock-error");
    const lockScreen = document.getElementById("lock-screen");
    const feedbackContent = document.getElementById("feedback-content");

    unlockBtn.addEventListener("click", () => {
      const userAnswer = answerInput.value.trim().toLowerCase();
      if (userAnswer === correctAnswer) {
        lockScreen.classList.add("hidden");
        feedbackContent.classList.remove("hidden");
      } else {
        errorText.textContent = "Esa no es la respuesta que espero 😏";
      }
    });

    // Enviar a Formspree sin recargar
    const form = document.getElementById("feedback-form");
    const status = document.getElementById("form-status");

    form.addEventListener("submit", async function (e) {
      e.preventDefault();

      const data = new FormData(form);
      const response = await fetch(form.action, {
        method: form.method,
        body: data,
        headers: {
          'Accept': 'application/json'
        }
      });

      if (response.ok) {
        status.textContent = "¡Gracias por tu feedback! 💖";
        form.reset();
      } else {
        status.textContent = "Hubo un error al enviar 😓 Inténtalo de nuevo.";
      }
    });
  </script>

  <a href="index.html" class="floating-button">⬅ Volver</a>

</body>
</html>
